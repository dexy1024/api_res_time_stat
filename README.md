# API 耗时统计工具

一个用于分析和可视化 API 调用耗时分布的 Web 应用程序。

## 功能特性

- 📊 **数据可视化**: 提供饼图展示耗时分布
- 📈 **统计分析**: 显示总调用次数、平均耗时、最长/最短耗时
- 📋 **详细表格**: 按接口名称展示平均耗时、最长耗时、最短耗时
- 📁 **文件上传**: 支持拖拽和点击上传 Excel 和 CSV 文件
- 📱 **响应式设计**: 适配不同屏幕尺寸

## 部署方式

### GitHub Pages 自动部署（推荐）

本项目已配置 GitHub Actions，支持自动部署到 GitHub Pages。

#### 部署步骤：

1. **创建 GitHub 仓库**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git branch -M main
   git remote add origin https://github.com/你的用户名/API_Time_Count.git
   git push -u origin main
   ```

2. **启用 GitHub Pages**
   - 进入仓库的 `Settings` > `Pages`
   - 在 `Source` 中选择 `GitHub Actions`
   - 保存设置

3. **自动部署**
   - 每次推送到 `main` 分支时，GitHub Actions 会自动构建并部署
   - 部署完成后，访问地址：`https://你的用户名.github.io/API_Time_Count/`

#### 手动触发部署

如果需要手动触发部署，可以在 GitHub 仓库的 `Actions` 标签页中手动运行工作流。

### 本地运行

#### 方式一：直接打开
直接在浏览器中打开 `index.html` 文件即可使用。

#### 方式二：使用本地服务器
```bash
# 使用 Python
python3 -m http.server 8000

# 或使用 Node.js (需要安装 http-server)
npx http-server -p 8000
```

然后在浏览器中访问 `http://localhost:8000`

## 使用方法

### 1. 打开应用
访问部署后的 GitHub Pages 地址，或直接在浏览器中打开 `index.html` 文件。

### 2. 上传数据文件
- 点击上传区域或直接拖拽文件到上传区域
- 支持 `.xlsx`、`.xls` 和 `.csv` 格式
- 文件上传后会自动解析，显示记录数量

### 3. 开始分析
- 点击"开始分析"按钮进行数据分析和可视化
- 分析完成后将显示：
  - **数据统计摘要**: 总调用次数、平均耗时等
  - **耗时分布图表**: 饼图展示各区间分布
  - **接口详情表格**: 每个接口的详细统计信息

### 4. 重新分析
- 如需重新分析，可点击"重新分析"按钮
- 或上传新文件后重新分析

## 数据文件格式要求

### 支持的文件格式
- **Excel 文件**: `.xlsx` 和 `.xls` 格式
- **CSV 文件**: `.csv` 格式（逗号分隔）

### 文件结构
数据文件应包含以下列：
- **第一列**: 接口名称（文本）
- **第二列**: 耗时（数值，单位：毫秒）

### Excel 示例格式
```
接口名称                   耗时(ms)
/api/user/login           245
/api/user/profile         156
/api/data/list            1234
/api/data/export          2100
/api/system/config        89
```

### CSV 示例格式
```csv
接口名称,耗时(ms)
/api/user/login,245
/api/user/profile,156
/api/data/list,1234
/api/data/export,2100
/api/system/config,89
```

### 带单位的 CSV 格式（也支持）
```csv
_col0,_col1
duiboxnum,1776ms
shelf,1633ms
keclodcabinet,3000ms
shelf,1610ms
duiboxnum,1546ms
```

### 注意事项
- 第一行可以是表头，程序会自动识别数据开始行
- 耗时列支持纯数值或带 "ms" 单位的格式
- 支持空行，程序会自动跳过
- 耗时值应为非负数
- CSV 文件使用逗号作为分隔符
- 程序会自动处理 `_col0`, `_col1` 等通用列标题

## 耗时区间分组

数据将按以下区间进行分组统计：
- 0-1000ms
- 1000-1500ms
- 1500-2000ms
- 2000-2500ms
- 2500-3000ms
- 3000-3500ms
- 3500-5000ms
- 5000ms以上

## 技术实现

### 前端技术栈
- **HTML5**: 页面结构
- **CSS3**: 样式和响应式布局
- **JavaScript (ES6+)**: 业务逻辑
- **Chart.js**: 数据可视化
- **SheetJS**: Excel 文件解析

### 核心功能
- Excel 和 CSV 文件解析和数据处理
- 耗时分布统计和可视化
- 接口级别的详细统计
- 表格排序功能
- 错误处理和用户提示

## 浏览器兼容性

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

## 文件结构

```
API_Time_Count/
├── .github/
│   └── workflows/
│       └── deploy.yml      # GitHub Actions 部署配置
├── .nojekyll              # 禁用 Jekyll 处理
├── .gitignore             # Git 忽略文件
├── index.html             # 主页面
├── style.css              # 样式文件
├── app.js                 # 业务逻辑
├── favicon.ico            # 网站图标
├── README.md              # 说明文档
└── 其他测试文件...
```

## 使用示例

1. 准备包含 API 调用数据的 Excel 或 CSV 文件
2. 在浏览器中打开 `index.html`
3. 上传数据文件
4. 查看分析结果和图表
5. 使用表格排序功能查看不同维度的数据

## 故障排除

### 常见问题

**Q: 上传文件后显示"未找到有效数据"**
A: 请检查文件格式，确保第一列是接口名称，第二列是耗时数值。

**Q: 图表不显示**
A: 请确保网络连接正常，Chart.js 库需要从 CDN 加载。

**Q: 文件解析失败**
A: 请确保文件是有效的格式（.xlsx、.xls 或 .csv），且文件未损坏。

**Q: CSV 文件解析错误**
A: 请确保 CSV 文件使用逗号作为分隔符，且数据格式正确。

### 数据格式检查
- 确保第一列包含接口名称（非空）
- 确保第二列包含数值型耗时数据
- 检查是否有特殊字符或格式问题
- CSV 文件确保使用逗号分隔符

## 更新日志

### v1.14.0
- 优化耗时区间分组，将"3000-5000ms"拆分为"3000-3500ms"和"3500-5000ms"
- 调整为8个区间，提供更精细的耗时分析
- 增加配色方案，支持8个区间的不同颜色显示
- 提升数据统计的精确性和可读性

### v1.13.0
- 新增接口数量统计功能
- 统计表格增加"数量"列，显示每个接口的调用次数
- 支持按数量排序，便于分析接口使用频率
- 完善数据分析维度，提供更全面的统计信息
- 优化表格结构，提升数据分析效率

### v1.12.0
- 新增接口中文名称映射，支持中文显示
- 统计表格增加"接口中文名"列
- 支持11种接口类型的中文名称显示
- 优化表格排序功能，支持中文名称排序
- 提升用户体验，便于理解接口含义

### v1.11.0
- 新增耗时分布统计表，基于饼图数据结构
- 显示每个耗时区间的数量、占比和颜色
- 提供更详细的数据分析视图
- 增强数据可视化的完整性

### v1.10.1
- 将"5000ms以上"区间调整为红色显示，突出异常耗时
- 增强视觉警示效果，便于识别性能问题
- 优化用户体验，快速定位需要优化的接口

### v1.10.0
- 优化耗时区间分组，将"0-500ms"和"500-1000ms"合并为"0-1000ms"
- 调整为7个区间，简化统计分组
- 优化配色方案，保持视觉区分度
- 提升数据统计的简洁性

### v1.9.0
- 优化耗时区间分组，将"3000ms以上"拆分为"3000-5000ms"和"5000ms以上"
- 增加配色方案，支持8个区间显示
- 提供更精细的耗时分布分析
- 提升数据统计的准确性

### v1.8.0
- 饼图尺寸增加到 500px，显示更清晰
- 在饼图上直接显示占比百分比
- 优化图例和标签显示
- 提升数据可视化效果

### v1.7.0
- 移除柱状图，简化界面设计
- 只保留饼图展示耗时分布
- 优化页面布局，饼图居中显示
- 提升页面加载性能

### v1.6.0
- 完全禁用图表动画，解决图表一直变化的问题
- 优化图表渲染性能，避免不必要的重绘
- 提升用户体验，图表显示更稳定
- 减少 CPU 使用率

### v1.5.0
- 修复 Chart.js 刻度生成警告问题
- 优化图表性能，限制 Y 轴刻度数量
- 改进图表动画和交互体验
- 提升大数据集处理性能

### v1.4.0
- 分离文件上传和数据分析流程
- 添加"开始分析"按钮，用户可控制分析时机
- 优化用户体验，避免上传后立即计算
- 支持重新分析功能

### v1.3.0
- 修复 Chart.js 加载问题，使用兼容版本
- 添加加载状态指示器
- 优化资源加载性能
- 添加 favicon 消除 404 错误

### v1.2.0
- 支持带 "ms" 单位的耗时数据格式
- 自动处理 `_col0`, `_col1` 等通用列标题
- 改进数据解析的兼容性

### v1.1.0
- 新增 CSV 文件支持
- 优化文件上传界面
- 改进错误处理

### v1.0.0
- 初始版本发布
- 支持 Excel 文件上传和解析
- 提供耗时分布可视化
- 支持接口级别统计
- 响应式设计
